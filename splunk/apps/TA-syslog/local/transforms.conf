# TA-syslog transforms.conf
# Sourcetype routing for network appliance syslog
# Customize regex patterns to match your device format

[syslog_sourcetype_routing]
# Generic routing - adapt to your device's log format
REGEX = (\[[\w\.\-]+\])\s+(\w+)
FORMAT = sourcetype::network:$2
DEST_KEY = MetaData:Sourcetype

# Content-based routing alternatives
[firewall_match]
REGEX = (ACCEPT|DROP|REJECT|BLOCK|ALLOW|DENY)
FORMAT = sourcetype::network:firewall
DEST_KEY = MetaData:Sourcetype

[dhcp_match]
REGEX = (DHCPACK|DHCPOFFER|DHCPREQUEST|DHCPDISCOVER)
FORMAT = sourcetype::network:dhcp
DEST_KEY = MetaData:Sourcetype

[dns_match]
REGEX = (query\[|dnsmasq|named)
FORMAT = sourcetype::network:dns
DEST_KEY = MetaData:Sourcetype
