# TA-syslog props.conf
# Technology Add-on for network appliance syslog
# Adapt field extractions to your specific device format

[source::udp:5514]
TRANSFORMS-sourcetype = syslog_sourcetype_routing

[network:firewall]
TIME_FORMAT = %b %d %H:%M:%S
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 10000

# Field extractions - customize for your device
# Example: Firewall log format
EXTRACT-firewall = (?<action>\w+)\s+(?<protocol>\w+)\s+(?<src_ip>\d+\.\d+\.\d+\.\d+):(?<src_port>\d+)\s+->\s+(?<dest_ip>\d+\.\d+\.\d+\.\d+):(?<dest_port>\d+)

# CIM Field Aliases
FIELDALIAS-src = src_ip AS src
FIELDALIAS-dest = dest_ip AS dest
FIELDALIAS-dvc = host AS dvc

[network:dhcp]
TIME_FORMAT = %b %d %H:%M:%S
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false

# Field extractions for DHCP
EXTRACT-dhcp = DHCPACK\s+on\s+(?<assigned_ip>\d+\.\d+\.\d+\.\d+)\s+to\s+(?<mac_address>[\w:]+)

[network:dns]
TIME_FORMAT = %b %d %H:%M:%S
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 20
SHOULD_LINEMERGE = false

# Field extractions for DNS
EXTRACT-dns = query\[(?<query_type>\w+)\]\s+(?<query_name>\S+)\s+from\s+(?<client_ip>\d+\.\d+\.\d+\.\d+)
