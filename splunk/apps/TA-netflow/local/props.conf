# TA-netflow props.conf
# Technology Add-on for NetFlow/IPFIX data
# Expects NDJSON format (one JSON object per line)

[network:netflow]
# JSON parsing
KV_MODE = json
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 50000

# Timestamp extraction from flow data
# Adjust TIME_PREFIX and TIME_FORMAT for your exporter
TIME_PREFIX = "first"\s*:\s*"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 30

# CIM Field Aliases for Network_Traffic data model
# Map your exporter's field names to CIM standard fields
FIELDALIAS-src_ip = src4_addr AS src_ip
FIELDALIAS-dest_ip = dst4_addr AS dest_ip
FIELDALIAS-src = src4_addr AS src
FIELDALIAS-dest = dst4_addr AS dest
FIELDALIAS-src_port = src_port AS src_port
FIELDALIAS-dest_port = dst_port AS dest_port
FIELDALIAS-protocol = proto AS protocol
FIELDALIAS-bytes_in = in_bytes AS bytes_in
FIELDALIAS-bytes = in_bytes AS bytes
FIELDALIAS-packets_in = in_packets AS packets_in
FIELDALIAS-packets = in_packets AS packets

# Calculated fields
EVAL-duration = strptime(last, "%Y-%m-%dT%H:%M:%S.%3N") - strptime(first, "%Y-%m-%dT%H:%M:%S.%3N")
EVAL-transport = case(proto=6, "tcp", proto=17, "udp", proto=1, "icmp", 1=1, proto)
